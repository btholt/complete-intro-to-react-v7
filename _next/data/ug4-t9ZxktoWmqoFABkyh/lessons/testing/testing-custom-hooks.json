{"pageProps":{"post":{"attributes":{"description":""},"html":"<p>Let&#39;s say we needs tests for our custom hook, useBreedList. Testing custom hooks is a bit of a trick because they are inherently tied to the internal workings of React: they can&#39;t be called outside of a component. So how we do we get around that? We fake a component! Make a file called useBreedList.test.js in our <code>__tests__</code> directory.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">/**\n * <span class=\"hljs-doctag\">@jest</span>-environment jsdom\n */</span>\n\n<span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@jest/globals&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { render } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@testing-library/react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> useBreedList <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../useBreedList.js&quot;</span>;\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">getBreedList</span>(<span class=\"hljs-params\">animal</span>) {\n  <span class=\"hljs-keyword\">let</span> list;\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">TestComponent</span>(<span class=\"hljs-params\"></span>) {\n    list = <span class=\"hljs-title function_\">useBreedList</span>(animal);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n  }\n\n  <span class=\"hljs-title function_\">render</span>(<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">TestComponent</span> /&gt;</span></span>);\n\n  <span class=\"hljs-keyword\">return</span> list;\n}\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;gives an empty list with no animal&quot;</span>, <span class=\"hljs-keyword\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> [breedList, status] = <span class=\"hljs-title function_\">getBreedList</span>();\n  <span class=\"hljs-title function_\">expect</span>(breedList).<span class=\"hljs-title function_\">toHaveLength</span>(<span class=\"hljs-number\">0</span>);\n  <span class=\"hljs-title function_\">expect</span>(status).<span class=\"hljs-title function_\">toBe</span>(<span class=\"hljs-string\">&quot;unloaded&quot;</span>);\n});\n</code></pre>\n<p>It&#39;s a little weird to implement a fake component to test something (we&#39;re dangerously close to the line of testing implementation details) but this is essentially library code and we want to assure ourselves this code works if we use it frequently in our code base.</p>\n<p>We can make this better though. There&#39;s a library called <code>@testing-library/react-hooks</code> that hides some of these details from us. Let&#39;s run <code>npm install -D @testing-library/react-hooks@7.0.2</code> and rewrite our test to look like this.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">/**\n * <span class=\"hljs-doctag\">@jest</span>-environment jsdom\n */</span>\n\n<span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@jest/globals&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { renderHook } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@testing-library/react-hooks&quot;</span>;\n<span class=\"hljs-keyword\">import</span> useBreedList <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../useBreedList.js&quot;</span>;\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;gives an empty list with no animal&quot;</span>, <span class=\"hljs-keyword\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> { result } = <span class=\"hljs-title function_\">renderHook</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title function_\">useBreedList</span>(<span class=\"hljs-string\">&quot;&quot;</span>));\n\n  <span class=\"hljs-keyword\">const</span> [breedList, status] = result.<span class=\"hljs-property\">current</span>;\n\n  <span class=\"hljs-title function_\">expect</span>(breedList).<span class=\"hljs-title function_\">toHaveLength</span>(<span class=\"hljs-number\">0</span>);\n  <span class=\"hljs-title function_\">expect</span>(status).<span class=\"hljs-title function_\">toBe</span>(<span class=\"hljs-string\">&quot;unloaded&quot;</span>);\n});\n</code></pre>\n<p>Here the helper <code>renderHook</code> abstracts away that oddity we had to do to get that hook tested. But rest assured it&#39;s doing essentially the same thing: creating a component under the hood that&#39;s running the hook lifecycle methods appropriately for you.</p>\n","slug":"testing-custom-hooks","title":"Testing Custom Hooks","section":"Testing","icon":"vial","filePath":"/home/runner/work/complete-intro-to-react-v7/complete-intro-to-react-v7/lessons/16-testing/D-testing-custom-hooks.md","nextSlug":"/complete-intro-to-react-v7/lessons/testing/mocks","prevSlug":"/complete-intro-to-react-v7/lessons/testing/testing-ui-interactions"}},"__N_SSG":true}